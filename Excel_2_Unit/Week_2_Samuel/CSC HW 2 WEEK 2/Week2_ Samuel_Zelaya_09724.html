<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Samuel Zelaya">

<title>Week2_Tutorial_Zelaya</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Week2_ Samuel_Zelaya_09724_files/libs/clipboard/clipboard.min.js"></script>
<script src="Week2_ Samuel_Zelaya_09724_files/libs/quarto-html/quarto.js"></script>
<script src="Week2_ Samuel_Zelaya_09724_files/libs/quarto-html/popper.min.js"></script>
<script src="Week2_ Samuel_Zelaya_09724_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Week2_ Samuel_Zelaya_09724_files/libs/quarto-html/anchor.min.js"></script>
<link href="Week2_ Samuel_Zelaya_09724_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Week2_ Samuel_Zelaya_09724_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Week2_ Samuel_Zelaya_09724_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Week2_ Samuel_Zelaya_09724_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Week2_ Samuel_Zelaya_09724_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week2_Tutorial_Zelaya</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Samuel Zelaya </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>#Wednesday 09/04/24</p>
<p>#New York Air Quality Dataset</p>
<section id="description" class="level2">
<h2 class="anchored" data-anchor-id="description"><strong>Description</strong></h2>
<p>The dataset contains daily air quality measurements in New York from May to September 1973. It focuses on six key variables related to atmospheric conditions: ozone levels, solar radiation, wind speed, temperature, month, and day. The data helps analyze the relationship between these variables and environmental factors.</p>
<section id="variables" class="level3">
<h3 class="anchored" data-anchor-id="variables"><strong>Variables</strong></h3>
<ol type="1">
<li><strong>Ozone</strong> (ppb): Measured between 1:00 PM and 3:00 PM at Roosevelt Island.</li>
<li><strong>Solar.R</strong> (Langleys): Solar radiation measured from 8:00 AM to 12:00 PM at Central Park.</li>
<li><strong>Wind</strong> (mph): Average wind speed at LaGuardia Airport, recorded between 7:00 AM and 10:00 AM.</li>
<li><strong>Temp</strong> (°F): Maximum daily temperature at LaGuardia Airport.</li>
<li><strong>Month</strong>: Numeric (1 = May, 9 = September).</li>
<li><strong>Day</strong>: Day of the month.</li>
</ol>
</section>
<section id="source" class="level3">
<h3 class="anchored" data-anchor-id="source"><strong>Source</strong></h3>
<p>Data was provided by the New York State Department of Conservation (ozone) and the National Weather Service (meteorological data).</p>
<p>#Dataset and Data Cleaning</p>
<ol type="1">
<li>We revisited the airquality_datasets.csv and created pivot tables.</li>
<li>I Cleaned the data by creating filters and deleting NA values and empty cells, similar to what was done in the first week.</li>
</ol>
<p>#<strong>Introduction to Histograms</strong> Professor introduced histograms and their functions, showing their simplicity and effectiveness in presenting data. Exploratory Analysis: Ozone Levels Histogram: The histogram illustrates the variability in ozone levels over time. Key Insights: High ozone levels are notable, but moderate and low levels are more prevalent. Elevated levels are less frequent, while moderate and low concentrations are common.</p>
<p><img src="Screenshot%20(379).png" class="img-fluid"></p>
</section>
</section>
<section id="saving-files-and-folder-organization" class="level1">
<h1><strong>Saving Files and Folder Organization</strong></h1>
<p>We learned how to save files properly for each week to ensure Quarto documents render correctly. Instructions: Save everything in the same folder for efficient document rendering.</p>
<p>#<strong>Ozone vs.&nbsp;Temperature: Scatter Plot Analysis</strong> The professor demonstrated a scatter plot comparing ozone levels and temperature. Key Insights: Positive correlation: Higher ozone levels generally occur with higher temperatures. Extreme ozone levels (115, 135, 168) appear with temperatures ranging from 79 to 97. Moderate ozone levels occur between temperatures of 70s to mid-80s. Lower ozone levels align with cooler temperatures. Overall, the scatter plot shows a clear trend of higher ozone levels being linked to warmer temperatures but with significant variability.</p>
<p><img src="Screenshot%20(381).png" class="img-fluid"></p>
</section>
<section id="pivot-tables-and-charts-real-class-topic" class="level1">
<h1>Pivot Tables and Charts (Real Class Topic)</h1>
<p>##<strong>Pivot Table Basics:</strong></p>
<ol type="1">
<li>I Inserted a pivot table on a new sheet.</li>
<li>Selected variables from the air quality dataset to input into rows and values.</li>
<li>The professor explained the count, sum, and average options for data analysis.</li>
<li>Finally, in class, we were asked to create our own version of a pivot table to understand, analyze, and interpret the data.</li>
</ol>
<p><strong>Key Insights:</strong> Higher temperatures and increased solar radiation are linked to higher ozone levels. As heat and sunlight rise, ozone levels generally increase, reflecting their strong correlation. Cooler temperatures and less sunlight lead to lower ozone concentrations, showing that both factors significantly influence ozone levels.</p>
<p><img src="Screenshot%20(380).png" class="img-fluid"></p>
</section>
<section id="friday-090724" class="level1">
<h1><strong>Friday 09/07/24</strong></h1>
<section id="work-in-class" class="level2">
<h2 class="anchored" data-anchor-id="work-in-class"><strong>Work in class</strong></h2>
<ol type="1">
<li><p>today the professor wanted us to go back into the creation of pivot tables,but now we had to make charts from the pivot tables</p></li>
<li><p>we kept on using on the same data set from from airquality and now we had to come up with as much as possible pivot table.</p></li>
</ol>
<section id="pivot-table-1-comparative-analysis-of-ozone-solar-radiation-wind-and-temperature-by-month" class="level3">
<h3 class="anchored" data-anchor-id="pivot-table-1-comparative-analysis-of-ozone-solar-radiation-wind-and-temperature-by-month"><strong>Pivot Table 1: Comparative Analysis of Ozone, Solar Radiation, Wind, and Temperature by Month</strong></h3>
<ol type="1">
<li>I did A “Comparative Analysis of Ozone, Solar Radiation, Wind, and Temperature by Month” using a clustered column chart</li>
</ol>
</section>
<section id="key-insights" class="level3">
<h3 class="anchored" data-anchor-id="key-insights"><strong>Key Insights:</strong></h3>
<p><strong>1. Temperature:</strong> Highest in row 9 (2230) and lowest in row 6 (704), likely reflecting seasonal or geographic factors.</p>
<p><strong>2.Wind:</strong> Highest wind speed in row 9 (292.2). Row 7 shows lower wind (221.6) despite high temperatures, suggesting terrain or local weather effects.</p>
<p><strong>3 Solar Radiation:</strong> High solar radiation corresponds with high temperatures in rows 7 (5627) and 9 (4878). Lower radiation in row 8 (3981) could be due to cloud cover or atmospheric conditions.</p>
<p><strong>4. Ozone:</strong> Ozone peaks in row 7 (1537), with no clear link to temperature, suggesting factors like pollution or altitude may influence levels.</p>
<p><strong>5.Wind:</strong>Wind generally increases with temperature (row 9: 292.2), but in row 7, lower wind (221.6) despite high temperatures suggests local factors like terrain or weather conditions affecting wind patterns.</p>
<p><strong>6.Solar Radiation:</strong>High solar radiation aligns with higher temperatures (row 7: 5627, row 9: 4878), though row 8’s lower radiation (3981) may be due to cloud cover or atmospheric conditions.</p>
<p><strong>7.Ozone:</strong> Ozone peaks in row 7 (1537), but there’s no clear link to temperature, suggesting factors like pollution, altitude, or industrial activity might influence ozone levels.</p>
<p><img src="Screenshot%20(389).png" class="img-fluid"></p>
</section>
<section id="pivot-table-2-minimum-levels-of-ozone-solar-radiation-wind-and-temperature-by-month" class="level3">
<h3 class="anchored" data-anchor-id="pivot-table-2-minimum-levels-of-ozone-solar-radiation-wind-and-temperature-by-month">Pivot Table 2: Minimum Levels of Ozone, Solar Radiation, Wind, and Temperature by Month</h3>
<p><strong>1.Solar Radiation</strong>: The lowest solar radiation is in row 7 (7), indicating minimal sunlight exposure, possibly due to increased cloud cover, shorter daylight hours, or winter months. Row 6 (37) and row 8 (24) are higher, suggesting more sunlight in those periods.</p>
<p><strong>2.Temperature:</strong>Row 5 has the lowest temperature (57), possibly reflecting a colder season or location. Row 7 (73) represents a slightly warmer period but still marks the minimum temperature in that context.</p>
<p><strong>3.Wind:</strong> The lowest wind speed is found in row 8 (2.3), likely due to calm conditions, while row 6 (8) shows stronger winds, possibly due to more open areas or seasonal wind patterns.</p>
<p><strong>These findings point to cooler, calmer, and less sunny conditions in specific months or locations, affected by seasonal or environmental factors.</strong></p>
<p><img src="Screenshot%20(397).png" class="img-fluid"></p>
</section>
<section id="pivot-table-3-maximum-levels-of-ozone-solar-radiation-wind-and-temperature-by-month" class="level3">
<h3 class="anchored" data-anchor-id="pivot-table-3-maximum-levels-of-ozone-solar-radiation-wind-and-temperature-by-month">Pivot Table 3: Maximum Levels of Ozone, Solar Radiation, Wind, and Temperature by Month</h3>
<p><strong>1. Solar Radiation:</strong> The highest solar radiation is in row 5 (334), followed closely by row 6 (323). This suggests that these months or locations receive the most sunlight, likely due to clearer skies or longer daylight hours. Temperature:</p>
<p><strong>2.Temperature:</strong> is in row 8 (97), reflecting a very warm period or location. Rows 7 (92) and 9 (93) also show high temperatures, indicating consistently hot conditions during these months. Wind:</p>
<p><strong>3.Wind:</strong> is in row 6 (20.7), which may indicate exposure to more intense weather conditions or open areas. Row 5 (20.1) also shows similarly high wind levels, while other rows exhibit slightly lower values. These findings suggest that rows 5 and 6 experience peak solar radiation and wind, while row 8 stands out for its extreme temperature, reflecting the influence of seasonal or geographical factors on these maximum values.</p>
<p><img src="Screenshot%20(395).png" class="img-fluid"></p>
</section>
<section id="pivot-table-4-average-levels-of-ozone-solar-radiation-wind-and-temperature-by-month" class="level3">
<h3 class="anchored" data-anchor-id="pivot-table-4-average-levels-of-ozone-solar-radiation-wind-and-temperature-by-month">Pivot Table 4: Average Levels of Ozone, Solar Radiation, Wind, and Temperature by Month</h3>
<p><strong>1,Solar Radiation:</strong> The highest average solar radiation is in row 7 (216.4), indicating that this month or location experiences the most consistent sunlight. Row 6 (184.2) and row 5 (182.0) also show relatively high averages, suggesting good sunlight exposure. Row 9 (168.2) and row 8 (173.1) have lower averages, possibly due to cloudier or less sunny periods. Temperature:</p>
<p><strong>2.Temperature</strong> The highest average temperature is in row 7 (83.9), reflecting warmer conditions. Row 8 (83.7) also has a high average temperature, indicating similar warm conditions. Row 6 (78.2) and row 9 (76.9) are cooler, and row 5 (66.5) is the lowest, suggesting cooler temperatures during this period. Wind:</p>
<p><strong>3. Wind</strong> The highest average wind speed is in row 6 (12.2), indicating stronger winds in that period. Row 5 (11.5) also shows relatively high wind speeds, while rows 7 (8.5), 8 (8.9), and 9 (10.1) have lower averages, suggesting calmer conditions.</p>
<p><img src="Screenshot%20(396).png" class="img-fluid"></p>
</section>
<section id="pivot-table-5-sum-of-ozone-solar-radiation-wind-and-temperature-by-month" class="level3">
<h3 class="anchored" data-anchor-id="pivot-table-5-sum-of-ozone-solar-radiation-wind-and-temperature-by-month">Pivot Table 5: Sum of Ozone, Solar Radiation, Wind, and Temperature by Month</h3>
<p><strong>1.Temperature:</strong> The highest sum of temperature is in row 9 (2230), followed by row 7 (2181). This indicates warmer conditions in these periods. The lowest sum is in row 6 (704), showing cooler conditions. Ozone:</p>
<p><strong>2.Ozone</strong> Row 7 has the highest total ozone (1537), suggesting higher ozone levels during this period. Row 5 has the lowest total ozone (579), indicating reduced ozone levels. Solar Radiation:</p>
<p><strong>3.Solar R</strong> The highest sum of solar radiation is in row 7 (5627), suggesting the most sunlight exposure. Row 6 has the lowest sum (1658), indicating less solar radiation. Wind:</p>
<p><strong>4.Wind</strong> The highest total wind is in row 9 (292.2), showing the most wind activity. Row 6 has the lowest total wind (109.6), reflecting calmer conditions. Trends:</p>
<p><strong>Temperature and solar radiation generally increase over time from row 6 to row 9, indicating a trend towards warmer and sunnier conditions. Wind shows variability, with the highest value in row 9 and lower values in other rows, suggesting fluctuating wind patterns. Ozone levels are highest in row 7 and lower in row 5, indicating varying ozone concentrations over time.</strong></p>
<p><img src="Screenshot%20(392).png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="last-week-1-dataset-overview" class="level1">
<h1>Last Week 1 Dataset Overview</h1>
<p><strong>Climate Change and Global Food Production</strong></p>
<p><strong>You can download the data used in this analysis from the following link: https://www.earthdata.nasa.gov/</strong></p>
<p><strong>Study Overview</strong></p>
<p>The study titled Effects of Climate Change on Global Food Production under SRES Emissions and Socio-Economic Scenarios is authored by Ana Iglesias from the Universidad Politécnica de Madrid and Cynthia Rosenzweig from NASA’s Goddard Institute for Space Studies. Published by NASA’s Socioeconomic Data and Applications Center (SEDAC) and managed by CIESIN at Columbia University in March 2010, this research delves into the impact of climate change on global staple crop production, focusing on wheat, rice, and maize.</p>
<p>###<strong>Main Focus</strong></p>
<p>The primary objective of this study is to assess how climate change might influence the production of staple crops on a global scale. By utilizing crop models and climate scenarios, the study simulates potential yield changes resulting from various environmental and socio-economic factors. It particularly highlights the risks posed by global warming on food security, with a focus on regions prone to drought and famine.</p>
<p>#<strong>Key Variables</strong></p>
<p>The dataset includes several key variables the only used right now where:</p>
<p>**1. BLS_2_Countries_(SRES)_ABBREVNAME: This represents the name of the country (e.g., Australia).**</p>
<p><strong>2.Fips_code: The country code (e.g., AS for Australia)</strong></p>
<p><strong>3.WH_2000: Average wheat production from 2000 to 2006 in metric tons, sourced from the FAO.</strong></p>
<p><strong>4.RI_2000: Average rice production from 2000 to 2006 in metric tons, sourced from the FAO.</strong></p>
<p><strong>5.MZ_2000: Average maize production from 2000 to 2006 in metric tons, sourced from the FAO</strong></p>
<p><strong>The purpose of this research is to evaluate the impacts of climate change on crop yields, specifically in relation to changes in temperature and precipitation. The study aims to identify potential adaptations and variations in yields across different countries and regions. It provides valuable insights into global food supply, price fluctuations, and the risks of hunger exacerbated by climate changes.</strong></p>
</section>
<section id="section" class="level1">
<h1></h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>